# Overview
- Tags: `picoCTF 2024` `Web Exploitation`
- `100 points`

# Description
Try [here](http://titan.picoctf.net:53784/) to find the flag

# Hints
* Try using burpsuite to intercept request to capture the flag.
* Try mangling the request, maybe their server-side code doesn't handle malformed requests very well.

# Solution
We have to use Burp Suite to complete this challenge. You can download the free version [here](https://portswigger.net/burp/communitydownload)

Once you download, install, and open the program, you'll switch to the `Proxy` tab and click `Open browser`

<kbd>![image](https://github.com/Bsnookie9/picoCTF-2024-WriteUps/assets/106827110/33be7a1d-e57d-461b-839d-b1674b1bd733)</kbd>

A new window will pop open and you'll enter the link address from the original challenge picoCTF window. Then hit enter.

> [!IMPORTANT]
> Make sure to turn on the interceptor so you can manually forward the packets

Now you'll need to click the Forward button to forward the first packet. Next you'll be prompted with a registration page in the new window

<kbd>![image](https://github.com/Bsnookie9/picoCTF-2024-WriteUps/assets/106827110/6fb07bfa-db3a-4027-90db-4631556d987a)</kbd>

Now enter random information into each text box. Then click submit.

<kbd>![image](https://github.com/Bsnookie9/picoCTF-2024-WriteUps/assets/106827110/18a638d6-0d3f-40e6-9084-5e098ae8c2f8)</kbd>

Here you'll see the details of the packet which contains the information you just entered. Click forward two times in BurpSuite.  
Now there is a new page asking for an OTP (One-Time Password). Enter a random number.

<kbd>![image](https://github.com/Bsnookie9/picoCTF-2024-WriteUps/assets/106827110/f4e6afb2-754d-4405-9e26-6e294ac95e6f)</kbd>

Forward the packet

<kbd>![image](https://github.com/Bsnookie9/picoCTF-2024-WriteUps/assets/106827110/54b0cb34-4c9e-4812-a792-bb45e0471d51)</kbd>

Obviously we gave the wrong OTP code. However, let's try mangling (manipulating) the packet for the OTP code, as the hint mentions.  
We can do this by going back to the OTP page by click the back arrow in the web browser and forwarding that packet in BurpSuite.  
You'll be presented with the same OTP page as before. Click submit again. This time, delete the section `otp=<your number>`.  
The packet information in BurpSuite should look something like this:

<kbd>![image](https://github.com/Bsnookie9/picoCTF-2024-WriteUps/assets/106827110/7bc1ece5-5b9c-43de-a1bb-b1fd4901d886)</kbd>

Now forward this mangled packet!

<kbd>![image](https://github.com/Bsnookie9/picoCTF-2024-WriteUps/assets/106827110/5522dd45-514d-40f0-b9d5-9d63ab231493)</kbd>

We've found the flag!

Flag: `picoCTF{#0TP_Bypvss_SuCc3$S_b3fa4f1a}`




